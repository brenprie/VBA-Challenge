# VBA Challenge - Stock Market Analysis

## Objective

1) Create a script that, for each quarter / worksheet, loops through daily stock data for all stocks and outputs the following information:
    * Ticker symbol
    * Quarterly change from opening price at beginning of quarter to closing price at end of quarter
    * Percentage change from opening price at beginning of quarter to closing price at end of quarter
    * Total quarterly volume of the stock.

   The result should match the following image:
      ![Screenshot 2024-10-25 at 12 25 19](https://github.com/user-attachments/assets/213a787f-7cdf-4b30-9225-f9ced8b6626b)

2) Again for each quarter / worksheet, loop through the output table from the prior step to return the tickers and values corresponding to the "Greatest % increase," "Greatest % decrease," and "Greatest total volume".

   The result should match the following image:
      ![Screenshot 2024-10-25 at 12 26 24](https://github.com/user-attachments/assets/cdf50d60-6a08-4861-b6be-d1b1fb33d715)

3) Use conditional formatting to match the output tables. Formatting I employed:
    * Positive (negative quarterly changes highlighted in green (red)
    * Autofit output table columns
    * Display percent results in "0.00%" format
    * Display greatest total volume in "#.00E+0" format

## Data and script files
1) Link to Excel data file on this repository:
    * https://github.com/brenprie/VBA-Challenge/blob/main/Multiple_year_stock_data.xlsx
   
2) Link to VBA code file on this repository:
    * https://github.com/brenprie/VBA-Challenge/blob/main/QuarterlyStockAnalysis-BP.bas

## Output

1) Image of first-quarter worksheet, to compare with above:  
     ![Q1 screenshot](https://github.com/user-attachments/assets/d999c7cb-e7d5-4838-8232-6089dc2342ef)

2) Links to screenshots for all four quarters on this repository: [Q1](https://github.com/brenprie/VBA-Challenge/blob/main/Q1%20screenshot.jpg), [Q2](https://github.com/brenprie/VBA-Challenge/blob/main/Q2%20screenshot.jpg), [Q3](https://github.com/brenprie/VBA-Challenge/blob/main/Q3%20screenshot.jpg), and [Q4](https://github.com/brenprie/VBA-Challenge/blob/main/Q4%20screenshot.jpg).


## Acknowledgements

The dataset was generated by edX Boot Camps LLC and is intended for educational purposes only.

## Useful Resources

* Microsoft:
  * https://learn.microsoft.com/en-us/office/vba/api/overview/excel
* Stack Overflow:
  * https://stackoverflow.com/questions/27065840/meaning-of-cells-rows-count-a-endxlup-row#:~:text=ws.-,Rows.,column%20%22A%22%20in%20the%20worksheet
  * https://stackoverflow.com/questions/41008736/how-to-get-cell-address-from-find-function-in-excel-vba
  * https://stackoverflow.com/questions/4626775/how-to-get-address-of-adjacent-cell
  * https://stackoverflow.com/questions/73109190/how-to-apply-match-in-loop-in-vba
  * https://stackoverflow.com/questions/31994570/excel-vba-if-statment-range-percentage
  * https://stackoverflow.com/questions/26039872/declaring-variable-workbook-worksheet-vba
* GitHub:
  * https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax 
